const database = [
    {
      Name: 'EseAbasi Mboso Obodom',
      Department: 'Electrical/Electronics Engineering',
      'Name of Institution': 'University of uyo',
      'Reg Number': '23/EG/EE/021'
    },
    {
      Name: 'Ekpo Promise Augustine',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/747'
    },
    {
      Name: 'Batta Abasiekem Hergert',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/748'
    },
      {
      Name: 'Ukpong Abasiama Christian',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/749'
    },
      {
      Name: 'Wilfred Enwongo Sunday',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/750'
    },
      {
      Name: 'Udonwa Umoh Umoh',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/751'
    },
      {
      Name: 'Okon Utibe Essien',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/752'
    },
      {
      Name: 'Okonson Tingwutobong Okon',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/753'
    },
      {
      Name: 'Udoh Endurance Ubong',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/755'
    },
      {
      Name: 'Icha Bridget Clement',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/757'
    },
      {
      Name: 'Ogbise Jeremiah Pemervzi',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/758'
    },
      {
      Name: 'Bassey Favour Etiobong',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/759'
    },
      {
      Name: 'Eno Jemimah Isaac',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/760'
    },
      {
      Name: 'Effiong Prince Emmanuel',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/762'
    },
      {
      Name: 'Sunday Emmanuel Oto-Abasi',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/763'
    },
      {
      Name: 'Etok Uyobong Mfon',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/765'
    },
      {
      Name: 'Adiaunam Victoria Okon',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/766'
    },
      {
      Name: 'Akpan Emmanuel George',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/767'
    },
      {
      Name: 'Udoh Immanuel Uko',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/768'
    },
      {
      Name: 'Vincent Okoh Mitchel',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/769'
    },
      {
      Name: 'Ntuen Anwangaabasi Ukana',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/770'
    },
      {
      Name: 'Donatus William Enobong',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/771'
    },
      {
      Name: 'Ita Glory Okon',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/772'
    },
      {
      Name: 'Okuku Chukwumela Kemdibe',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/773'
    },
      {
      Name: 'Ekpo Wisdom Emmanuel',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/774'
    },
      {
      Name: 'Ukpong Etebom Abel',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/775'
    },
      {
      Name: 'Ekpene Idara Sunday',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/776'
    },
      {
      Name: 'Chukwuka Henry Chukwuma',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/777'
    },
      {
      Name: 'Ekong Idiongomfon',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/779'
    },
      {
      Name: 'Ekanem Wisdom Jonathan',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/780'
    },
      {
      Name: 'Ibok Joseph Etim',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/781'
    },
      {
      Name: 'Ekpe Emmanuel Imo',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/782'
    },
      {
      Name: 'Mbuk Nsideabasi Joseph',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/783'
    },
      {
      Name: 'Jeremiah Ebito Bassey',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/785'
    },
      {
      Name: 'Edem Precious Michael',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/786'
    },
      {
      Name: 'Joseph Emmanuel Christian',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/787'
    },
      {
      Name: 'Ogun Osolobrughwekaro',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/788'
    },
      {
      Name: 'Ekong Fubm Paul',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/789'
    },
      {
      Name: 'Ntekim Idorenyin Eyoh',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/792'
    },
      {
      Name: 'Nyanga Edidiong Nyanga',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/793'
    },
      {
      Name: 'Henny Joshua',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/794'
    },
      {
      Name: 'Hilley-Joe Wisdom Dunamis',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/795'
    },
      {
      Name: 'Oloruntoba Temitope Michael',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/796'
    },
      {
      Name: 'Egbe Jonah Enyong',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/797'
    },
      {
      Name: 'Moornu Benjamin Nduka',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/798'
    },
      {
      Name: 'Ubong Editi Inyang',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/799'
    },
      {
      Name: 'James Abasifreke Udo',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/800'
    },
      {
      Name: 'Victor Denise Idongesit',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/801'
    },
      {
      Name: 'Akpan Israel Effiong',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/802'
    },
      {
      Name: 'Kalu Chibuike Harvey',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/803'
    },
      {
      Name: 'David Divine Reginald',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/805'
    },
      {
      Name: 'Makok Wisdom Anibe',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/716'
    },
      {
      Name: 'Inyang Nicholas Michael',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/717'
    },
      {
      Name: 'Effiong Imaobong Sarah',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/718'
    },
      {
      Name: 'Inyang Mkpouto Simeon',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/720'
    },
      {
      Name: 'Asuquo Etiuduot Bassey',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/722'
    },
      {
      Name: 'Okon Harry Israel',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/724'
    },
      {
      Name: 'Ndada Joshua Nsikakabasi',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/725'
    },
      {
      Name: 'James Ndiuwem Offiong',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/726'
    },
      {
      Name: 'Akpovwovwo Oghenewegba',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/727'
    },
      {
      Name: 'Effiong Aniekan Sunday',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/729'
    },
      {
      Name: 'Okpukpan Victor Akan',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/730'
    },
      {
      Name: 'Ottah David Chibuikem',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/732'
    },
      {
      Name: 'Udom Abasi-Ikponke Isaiah',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/733'
    },
      {
      Name: 'Ndubueze Honour',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/734'
    },
      {
      Name: 'Ezenugo Nosisochukwu Salem',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/736'
    },
      {
      Name: 'Douglas Emmanuel Ekanem',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/737'
    },
      {
      Name: 'Uko Valentine Bassey',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/739'
    },
      {
      Name: 'Idiong FearGod Ebong',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/740'
    },
      {
      Name: 'Sam Godson Joseph',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/741'
    },
      {
      Name: 'Nwafor Amarachi Stella',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/742'
    },
      {
      Name: 'Odiongito George Upere',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/743'
    },
      {
      Name: 'Umeh Chinaza Paulinus',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/744'
    },
      {
      Name: 'Edwin Victoria Willie',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/745'
    },
      {
      Name: 'Effiong David Bassey',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/746'
    },
      {
      Name: 'Kola Bidemi Blessing',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/806'
    },
      {
      Name: 'David Shalom Brown',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/807'
    },
      {
      Name: 'Okon Michael Emmanuel',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/808'
    },
      {
      Name: 'Umoh Daniel Raymond',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/809'
    },
      {
      Name: 'Daniel Effiom Okon',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/811'
    },
      {
      Name: 'Udoette Ubong Uwem',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/813'
    },
      {
      Name: 'Chukwu Mmesoma Precious',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/814'
    },
      {
      Name: 'Etienam Etienam Clement',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/815'
    },
      {
      Name: 'Udosen Idongesit Emmanuel',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/817'
    },
      {
      Name: 'Nwankwo Samuel John',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/818'
    },
      {
      Name: 'Effiong Idiongo Chrysantus',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/819'
    },
      {
      Name: 'Enoh Ubongabasi Effiong',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/820'
    },
      {
      Name: 'Bassey Moses Ubong',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/821'
    },
      {
      Name: 'Eyah Asuquo Peter',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/822'
    },
      {
      Name: 'Sunday Gabriel Nathan',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/823'
    },
      {
      Name: 'John Emmanuel Jemegah',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/824'
    },
      {
      Name: 'Ekanem Iniobong Godwin',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/825'
    },
      {
      Name: 'Okon Abasiono Eyo',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/826'
    },
      {
      Name: 'Akpan Enyeneabasi Augustine',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/827'
    },
      {
      Name: 'Ufada David Undigwele',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/828'
    },
      {
      Name: 'Ufford Josephine Emmanuel',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/829'
    },
      {
      Name: 'Trusting Favour Iyamah',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/830'
    },
      {
      Name: 'Eneh-Harold Zerubbabel',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/832'
    },
      {
      Name: 'Obot Favour Imecletus',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/833'
    },
      {
      Name: 'Okpoho Evesu Ekarika',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/837'
    },
      {
      Name: 'Akang Gideon Eyibio',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/838'
    },
      {
      Name: 'Okon Promise Enefiok',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/840'
    },
      {
      Name: 'Nssien Joseph Udia',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/841'
    },
      {
      Name: 'James Ikankeabasi James',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/843'
    },
      {
      Name: 'Effiong Favour Edet',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/844'
    },
      {
      Name: 'Etim Emmanuel Ime',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/845'
    },
      {
      Name: 'Moses Krigbode Tam',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/846'
    },
      {
      Name: 'Atakpa Andikan Larry',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/847'
    },
      {
      Name: 'Hanson Faith',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/848'
    },
      {
      Name: 'Udoeyop Itoro Nyong',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/849'
    },
      {
      Name: 'Ewa Esther Okon',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/850'
    },
      {
      Name: 'Ekandem Kenneth Iniekong',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/852'
    },
      {
      Name: 'Saviour Samuel Ubong',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/854'
    },
      {
      Name: 'Whyte Kindness Samuel',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/855'
    },
      {
      Name: 'Ezeh Victor Chukwunonso',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/856'
    },
      {
      Name: 'Ndifreke Kingsley Bernard',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/857'
    },
      {
      Name: 'Wilson Nyene Emmanuel',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/858'
    },
      {
      Name: 'David Philliah Yusuf',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/859'
    },
      {
      Name: 'Abraham Kingdavid Francis',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/862'
    },
      {
      Name: 'Ekanem Ubong Jimmy',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/863'
    },
      {
      Name: 'Benstowe Onimim Victor',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/864'
    },
      {
      Name: 'Akpan Noah Ufot',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/865'
    },
      {
      Name: 'Ashiwel Grace Agidunim',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/866'
    },
      {
      Name: 'Asuquo Faith Udeme',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/867'
    },
      {
      Name: 'Peters Emmanuel Godwin',
      Department: 'Computer Science',
      'Name of Institution': 'University of uyo',
      'Reg Number': '19/SC/CO/868'
    }
  ];
  
  function writeText(text){
          let index = 0;
          function writeNextLetter(){
            if(index < text.length){
              document.getElementById('head').innerHTML += text.charAt(index);
              index++;
            } else{
              clearInterval(interval);
            }
          }
          let interval = setInterval(writeNextLetter, 100);
        }
        writeText('Please fill out the fields below.');


document.getElementById('getIdBtn').onclick = function() {
  const regNumber = document.getElementById('regNumber').value.trim();
  
 

  if (regNumber in database) {
    const userId = database[regNumber];
    alert('Your ID is: ' + userId); 
  } else {
    alert('Your Id is: ' + generateUniqueId());
  }
};
document.getElementById('registration-form').addEventListener('submit', async function (event) {
  event.preventDefault();

  const spinner = document.getElementById('spinner');
  spinner.style.display = 'block';

  const form = event.target;
  const formData = new FormData(form);
  const formObject = {};
  formData.forEach((value, key) => {
    formObject[key] = value.trim().toLowerCase();
  });

  const name = formObject['Name'];
  const department = formObject['Department'];
  const institution = formObject['Name of Institution'];
  const regNumber = formObject['Reg Number'];

  const nameParts = name.split(' ');
  const userRecord = database.find(record =>
    record.Department.toLowerCase().trim() === department &&
    record['Name of Institution'].toLowerCase().trim() === institution &&
    record['Reg Number'].toLowerCase().trim() === regNumber &&
    nameParts.some(part => record.Name.toLowerCase().includes(part))
  );

  if (!userRecord) {
    alert('Database not found');
    spinner.style.display = 'none';
    return;
  }

  const uniqueId = generateUniqueId();
  document.getElementById('userId').textContent = uniqueId;
  document.getElementById('idModal').style.display = 'block';

  document.getElementById('continueButton').onclick = function() {
    document.getElementById('idModal').style.display = 'none';
    document.getElementById('verifyModal').style.display = 'block';
  };

  document.getElementById('idModalClose').onclick = function() {
    document.getElementById('idModal').style.display = 'none';
  };

  document.getElementById('verifyModalClose').onclick = function() {
    document.getElementById('verifyModal').style.display = 'none';
  };

  document.getElementById('idVerificationForm').addEventListener('submit', async function(event) {
    event.preventDefault();
    const enteredId = document.getElementById('enteredId').value.trim();

    if (enteredId === uniqueId) {
      document.getElementById('verifyModal').style.display = 'none';
      await generateCertificate(formData);
      document.getElementById('successModal').style.display = 'block';
    } else {
      alert('Incorrect ID');
    }
  });

  spinner.style.display = 'none';
});

function generateUniqueId() {
  return 'ID' + Math.random().toString(36).substr(2, 9).toUpperCase();
}

async function generateCertificate(formData) {
  const name = formData.get('Name');
  const institution = formData.get('Name of Institution');
  const regNumber = formData.get('Reg Number');
  const department = formData.get('Department');
  const cgpa = parseFloat(formData.get('CGPA') || 0);
  let grade;

  if (cgpa >= 4.5 && cgpa <= 5) {
    grade = "First Class Honours";
  } else if (cgpa >= 3.5 && cgpa < 4.5) {
    grade = "Second Class Upper";
  } else if (cgpa >= 2.5 && cgpa < 3.5) {
    grade = "Second Class Lower";
  } else if (cgpa >= 0 && cgpa < 2.5) {
    grade = "Third Class";
  } else {
    grade = "Pass";
  }

  const { jsPDF } = window.jspdf;
  const doc = new jsPDF('landscape');
  const img = await getImageData('ese.jpg');
  doc.addImage(img, 'JPEG', 0, 0, doc.internal.pageSize.getWidth(), doc.internal.pageSize.getHeight());
  
  doc.setFont('helvetica');

  // Title
  doc.setFontSize(30);
  doc.setFont('helvetica', 'bold');
  doc.setTextColor(184, 134, 11);
  doc.text(`${institution.toUpperCase()}`, doc.internal.pageSize.getWidth() / 2, 40, { align: 'center' });

  // Subtitle
  doc.setFontSize(20);
  doc.setFont('helvetica', 'normal');
  doc.setTextColor(0, 0, 0);
  doc.text('Certificate of Completion', doc.internal.pageSize.getWidth() / 2, 60, { align: 'center' });

  // Name
  doc.setFontSize(20);
  doc.setFont('helvetica');
  doc.setTextColor(0, 51, 102);
  doc.text(`${name}`, doc.internal.pageSize.getWidth() / 2, 80, { align: 'center' });

  // Reg Number
  doc.setFontSize(15);
  doc.setFont('helvetica', 'normal');
  doc.setTextColor(128, 128, 128);
  doc.text(`${regNumber}`, doc.internal.pageSize.getWidth() / 2, 90, { align: 'center' });

  doc.setLineWidth(2);
  doc.setDrawColor(184, 134, 11);
  doc.line(
    doc.internal.pageSize.getWidth() / 2 - 90, 95,
    doc.internal.pageSize.getWidth() / 2 + 90, 95
  );

  // Text
  doc.setFontSize(18);
  doc.setFont('normal', 'normal');
  doc.setTextColor(0, 0, 0);
  doc.text(`Completed the approved course of study and fulfilled all the prescribed conditions in the degree program. B.Sc ${department}`, doc.internal.pageSize.getWidth() / 2, 110, { align: 'center', maxWidth: 250 });

  // CGPA and Grade
  doc.setFontSize(17);
  doc.setFont('helvetica', 'normal');
  doc.setTextColor(0, 0, 0);
  doc.text(`And has earned a CGPA of ${cgpa.toFixed(2)} (${grade}) in the course`, doc.internal.pageSize.getWidth() / 2, 130, { align: 'center' });

  // Course
  doc.setFontSize(20);
  doc.setFont('helvetica', 'normal');
  doc.setTextColor(0, 0, 0);
  doc.text(`B.Sc ${department}`, doc.internal.pageSize.getWidth() / 2, 140, { align: 'center' });

  // Institution and RegNo
  doc.setFontSize(14);
  doc.setFont('helvetica', 'normal');
  doc.setTextColor(0, 0, 0);
  doc.text(`Institution: ${institution}`, doc.internal.pageSize.getWidth() / 2, 160, { align: 'center' });
  doc.text(`Registration Number: ${regNumber}`, doc.internal.pageSize.getWidth() / 2, 170, { align: 'center' });

  doc.setFontSize(14);
  doc.setFont('helvetica', 'normal');
  doc.setTextColor(0, 0, 0);
  doc.text('This certificate is duly issued on the following day:', doc.internal.pageSize.getWidth() / 2, 180, { align: 'center' });
  const date = new Date().toLocaleDateString();
  doc.text(date, doc.internal.pageSize.getWidth() / 2, 190, { align: 'center' });

  doc.save(`${name}_certificate.pdf`);

  const formspreeEndpoint = 'https://formspree.io/f/xleqkzrr'; 
  const formspreeData = {
    name: name,
    regNumber: regNumber,
    certificateUrl: `${name}_certificate.pdf`
  };

  await fetch(formspreeEndpoint, {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
    },
    body: JSON.stringify(formspreeData),
  }).then(response => {
    if (!response.ok) throw new Error('Error: 500 Internal Server Error');
  }).catch(error => {
    alert('Error: 500 Internal Server Error');
    console.error('Error:', error);
  });
}

async function getImageData(imageUrl) {
  const response = await fetch(imageUrl);
  const blob = await response.blob();
  return new Promise((resolve) => {
    const reader = new FileReader();
    reader.onload = () => resolve(reader.result);
    reader.readAsDataURL(blob);
  });
}

document.getElementById('getIdLink').onclick = function() {
  document.getElementById('regInput').style.display = 'block';
};

